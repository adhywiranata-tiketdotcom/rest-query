var e=require("react");function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var r=e.createContext({store:null}),n={isLoading:!1,error:null,data:null},o={CACHE_FIRST:"cache-first",NETWORK_ONLY:"network-only",CACHE_ONLY:"cache-only"},a={key:null,cachePolicy:o.CACHE_FIRST};exports.RestQueryProvider=function(n){var o=n.children,a=e.useState({}),c=a[0],i=a[1];return e.createElement(r.Provider,{value:{store:c,getCachedData:function(e){if(!c[e])return null;try{var t;return JSON.parse(null==(t=c[e])?void 0:t.data)}catch(e){return console.log("[RESTICACHE ERROR]",e),null}},setCacheData:function(e,r){var n,o=JSON.stringify(r);i(t({},c,((n={})[e]={data:o,cacheStoredAt:null,cacheExpiredAt:null},n)))}}},o)},exports.useCacheable=function(c,i){void 0===i&&(i=a);var u,l,s=(u=i,l=t({},a),Object.keys(u).forEach(function(e){Object.prototype.hasOwnProperty.call(a,e)?l[e]=u[e]:console.warn("[RESTICACHE WARNING]",function(e){return"Option ["+e+"] is not part of the API. While this is not an error, ensure the options matches the API."}(e))}),l),h=e.useContext(r),f=s.key||btoa(c),C=h.getCachedData(f),d=Boolean(C),v=s.cachePolicy!==o.NETWORK_ONLY,y=[o.CACHE_FIRST,o.NETWORK_ONLY].includes(s.cachePolicy),O=d&&v,E=t({},n,{data:C}),p=e.useState(O?E:n),P=p[0],R=p[1],A=e.useCallback(function(){try{return d||!y?Promise.resolve():(R(t({},P,{isLoading:!0})),Promise.resolve(function(e){try{return Promise.resolve(window.fetch(e)).then(function(e){return Promise.resolve(e.json())})}catch(e){return Promise.reject(e)}}(c)).then(function(e){R(t({},P,{data:e})),v&&h.setCacheData(f,e)}))}catch(e){return Promise.reject(e)}},[d,y,P,c,v,h,f]);return e.useEffect(function(){A()},[]),P};
//# sourceMappingURL=index.js.map
