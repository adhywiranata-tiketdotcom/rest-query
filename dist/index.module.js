import{useEffect as e,createContext as r,useContext as t,useState as n,useCallback as o,createElement as a}from"react";function c(){return(c=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var i=r({store:null}),l={isLoading:!1,error:null,data:null},u={CACHE_FIRST:"cache-first",NETWORK_ONLY:"network-only",CACHE_ONLY:"cache-only"},s={key:null,cachePolicy:u.CACHE_FIRST};function h(r,a){void 0===a&&(a=s);var h,f,d=(h=a,f=c({},s),Object.keys(h).forEach(function(e){Object.prototype.hasOwnProperty.call(s,e)?f[e]=h[e]:console.warn("[RESTICACHE WARNING]",function(e){return"Option ["+e+"] is not part of the API. While this is not an error, ensure the options matches the API."}(e))}),f),v=t(i),y=d.key||btoa(r),O=v.getCachedData(y),C=Boolean(O),p=d.cachePolicy!==u.NETWORK_ONLY,P=[u.CACHE_FIRST,u.NETWORK_ONLY].includes(d.cachePolicy),E=C&&p,R=c({},l,{data:O}),A=n(E?R:l),N=A[0],m=A[1],g=o(function(){try{return C||!P?Promise.resolve():(m(c({},N,{isLoading:!0})),Promise.resolve(function(e){try{return Promise.resolve(window.fetch(e)).then(function(e){return Promise.resolve(e.json())})}catch(e){return Promise.reject(e)}}(r)).then(function(e){m(c({},N,{data:e})),p&&v.setCacheData(y,e)}))}catch(e){return Promise.reject(e)}},[C,P,N,r,p,v,y]);return e(function(){g()},[]),N}function f(e){var r=e.children,t=n({}),o=t[0],l=t[1];return a(i.Provider,{value:{store:o,getCachedData:function(e){if(!o[e])return null;try{var r;return JSON.parse(null==(r=o[e])?void 0:r.data)}catch(e){return console.log("[RESTICACHE ERROR]",e),null}},setCacheData:function(e,r){var t,n=JSON.stringify(r);l(c({},o,((t={})[e]={data:n,cacheStoredAt:null,cacheExpiredAt:null},t)))}}},r)}export{f as ResicacheProvider,h as useCacheable};
//# sourceMappingURL=index.module.js.map
