import{useEffect as e,createContext as t,useContext as r,useState as n,useCallback as o,createElement as a}from"react";function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var i=t({store:null}),l={isLoading:!1,error:null,data:null},u={CACHE_FIRST:"cache-first",NETWORK_ONLY:"network-only",CACHE_ONLY:"cache-only"},s={key:null,cachePolicy:u.CACHE_FIRST};function h(t,a){void 0===a&&(a=s);var h,f,d=(h=a,f=c({},s),Object.keys(h).forEach(function(e){Object.prototype.hasOwnProperty.call(s,e)?f[e]=h[e]:console.warn("[RESTICACHE WARNING]",function(e){return"Option ["+e+"] is not part of the API. While this is not an error, ensure the options matches the API."}(e))}),f),y=r(i),O=d.key||btoa(t),v=y.getCachedData(O),C=Boolean(v),p=d.cachePolicy!==u.NETWORK_ONLY,E=[u.CACHE_FIRST,u.NETWORK_ONLY].includes(d.cachePolicy),P=C&&p,R=c({},l,{data:v}),A=n(P?R:l),N=A[0],m=A[1],g=o(function(){try{return C||!E?Promise.resolve():(m(c({},N,{isLoading:!0})),Promise.resolve(function(e){try{return Promise.resolve(window.fetch(e)).then(function(e){return Promise.resolve(e.json())})}catch(e){return Promise.reject(e)}}(t)).then(function(e){m(c({},N,{data:e})),p&&y.setCacheData(O,e)}))}catch(e){return Promise.reject(e)}},[C,E,N,t,p,y,O]);return e(function(){g()},[]),N}function f(e){var t=e.children,r=n({}),o=r[0],l=r[1];return a(i.Provider,{value:{store:o,getCachedData:function(e){if(!o[e])return null;try{var t;return JSON.parse(null==(t=o[e])?void 0:t.data)}catch(e){return console.log("[RESTICACHE ERROR]",e),null}},setCacheData:function(e,t){var r,n=JSON.stringify(t);l(c({},o,((r={})[e]={data:n,cacheStoredAt:null,cacheExpiredAt:null},r)))}}},t)}export{f as RestQueryProvider,h as useCacheable};
//# sourceMappingURL=index.module.js.map
